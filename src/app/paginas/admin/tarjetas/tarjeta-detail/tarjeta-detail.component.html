<div class="container mx-auto px-4 py-8">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold text-gray-800">Detalle de Tarjeta Digital</h1>
    <div class="space-x-3">
      <button
        type="button"
        (click)="editar()"
        class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md flex items-center transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-2"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
          />
        </svg>
        Editar
      </button>
      <button
        type="button"
        (click)="volver()"
        class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-md flex items-center transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 mr-2"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 19l-7-7m0 0l7-7m-7 7h18"
          />
        </svg>
        Volver
      </button>
    </div>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="isLoading()" class="flex justify-center items-center py-32">
    <div class="text-center">
      <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mx-auto mb-4"></div>
      <p class="text-gray-600">Cargando información de la tarjeta...</p>
    </div>
  </div>

  <!-- Mensaje de error -->
  <div
    *ngIf="errorMessage()"
    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"
  >
    <div class="flex">
      <svg
        class="h-6 w-6 text-red-500 mr-3"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      <span>{{ errorMessage() }}</span>
    </div>
  </div>

  <!-- Contenido principal -->
  <div *ngIf="!isLoading() && !errorMessage() && tarjetaData()" class="space-y-6">
    
    <!-- Información básica y estado -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex items-start justify-between">
        <div class="flex items-center space-x-4">
          <!-- Foto de perfil -->
          <div class="w-20 h-20 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center flex-shrink-0">
            <img 
              *ngIf="tarjetaData()?.personal_info?.photo" 
              [src]="obtenerUrlImagen(tarjetaData()?.personal_info?.photo)" 
              [alt]="tarjetaData()?.personal_info?.name || 'Tarjeta'"
              class="w-full h-full object-cover"
            />
            <svg 
              *ngIf="!tarjetaData()?.personal_info?.photo"
              class="w-8 h-8 text-gray-400" 
              fill="currentColor" 
              viewBox="0 0 20 20"
            >
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <!-- Información básica -->
          <div>
            <h2 class="text-xl font-bold text-gray-900">
              {{ tarjetaData()?.personal_info?.name || 'Sin nombre' }}
            </h2>
            <p class="text-gray-600">
              {{ tarjetaData()?.personal_info?.title || 'Sin título' }}
            </p>
            <p class="text-sm text-gray-500">
              {{ tarjetaData()?.personal_info?.location || 'Sin ubicación' }}
            </p>
          </div>
        </div>
        
        <!-- Estados y controles -->
        <div class="flex flex-col space-y-3">
          <!-- Estado Activo -->
          <div class="flex items-center space-x-3">
            <span 
              class="px-3 py-1 rounded-full text-sm font-medium cursor-pointer"
              [ngClass]="{
                'bg-green-100 text-green-800': tarjetaData()?.is_active,
                'bg-red-100 text-red-800': !tarjetaData()?.is_active
              }"
              (click)="toggleStatus('is_active')"
              title="Click para cambiar estado"
            >
              {{ tarjetaData()?.is_active ? 'Activa' : 'Inactiva' }}
            </span>
            <button
              (click)="toggleStatus('is_active')"
              class="text-blue-600 hover:text-blue-700 text-sm"
              title="Cambiar estado activo"
            >
              Cambiar
            </button>
          </div>

          <!-- Estado Público -->
          <div class="flex items-center space-x-3">
            <span 
              class="px-3 py-1 rounded-full text-sm font-medium cursor-pointer"
              [ngClass]="{
                'bg-blue-100 text-blue-800': tarjetaData()?.is_public,
                'bg-gray-100 text-gray-800': !tarjetaData()?.is_public
              }"
              (click)="toggleStatus('is_public')"
              title="Click para cambiar visibilidad"
            >
              {{ tarjetaData()?.is_public ? 'Pública' : 'Privada' }}
            </span>
            <button
              (click)="toggleStatus('is_public')"
              class="text-blue-600 hover:text-blue-700 text-sm"
              title="Cambiar visibilidad"
            >
              Cambiar
            </button>
          </div>
        </div>
      </div>

      <!-- Metadatos -->
      <div class="mt-6 pt-6 border-t border-gray-200">
        <dl class="grid grid-cols-1 gap-4 sm:grid-cols-3">
          <div>
            <dt class="text-sm font-medium text-gray-500">ID</dt>
            <dd class="mt-1 text-sm text-gray-900">{{ tarjetaData()?.id }}</dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-gray-500">Slug</dt>
            <dd class="mt-1 text-sm text-gray-900">{{ tarjetaData()?.slug }}</dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-gray-500">Creada</dt>
            <dd class="mt-1 text-sm text-gray-900">{{ formatearFecha(tarjetaData()?.created_at!) }}</dd>
          </div>
        </dl>
      </div>
    </div>

    <!-- Información de Contacto -->
    <div *ngIf="tarjetaData()?.contact_info" class="bg-white rounded-lg shadow-md p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Información de Contacto</h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        
        <div *ngIf="tarjetaData()?.contact_info?.email" class="flex items-center space-x-3">
          <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
          </svg>
          <div>
            <dt class="text-sm font-medium text-gray-500">Email</dt>
            <dd class="text-sm text-gray-900">{{ tarjetaData()?.contact_info?.email }}</dd>
          </div>
        </div>

        <div *ngIf="tarjetaData()?.contact_info?.phone" class="flex items-center space-x-3">
          <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path>
          </svg>
          <div>
            <dt class="text-sm font-medium text-gray-500">Teléfono</dt>
            <dd class="text-sm text-gray-900">{{ tarjetaData()?.contact_info?.phone }}</dd>
          </div>
        </div>

        <div *ngIf="tarjetaData()?.contact_info?.website" class="flex items-center space-x-3">
          <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.56-.5-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.56.5.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.498-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z" clip-rule="evenodd"></path>
          </svg>
          <div>
            <dt class="text-sm font-medium text-gray-500">Sitio Web</dt>
            <dd class="text-sm text-blue-600">
              <a [href]="tarjetaData()?.contact_info?.website" target="_blank" rel="noopener noreferrer" class="hover:underline">
                {{ tarjetaData()?.contact_info?.website }}
              </a>
            </dd>
          </div>
        </div>

        <div *ngIf="tarjetaData()?.contact_info?.linkedin" class="flex items-center space-x-3">
          <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.338 16.338H13.67V12.16c0-.995-.017-2.277-1.387-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248H8.014v-8.59h2.559v1.174h.037c.356-.675 1.227-1.387 2.526-1.387 2.703 0 3.203 1.778 3.203 4.092v4.711zM5.005 6.575a1.548 1.548 0 11-.003-3.096 1.548 1.548 0 01.003 3.096zm-1.337 9.763H6.34v-8.59H3.667v8.59zM17.668 1H2.328C1.595 1 1 1.581 1 2.298v15.403C1 18.418 1.595 19 2.328 19h15.34c.734 0 1.332-.582 1.332-1.299V2.298C19 1.581 18.402 1 17.668 1z" clip-rule="evenodd"></path>
          </svg>
          <div>
            <dt class="text-sm font-medium text-gray-500">LinkedIn</dt>
            <dd class="text-sm text-blue-600">
              <a [href]="tarjetaData()?.contact_info?.linkedin" target="_blank" rel="noopener noreferrer" class="hover:underline">
                LinkedIn
              </a>
            </dd>
          </div>
        </div>

        <!-- Puedes agregar más campos de contacto aquí siguiendo el mismo patrón -->
        
      </div>
    </div>

    <!-- Información About -->
    <div *ngIf="tarjetaData()?.about_info" class="bg-white rounded-lg shadow-md p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Acerca de</h3>
      
      <div *ngIf="tarjetaData()?.about_info?.description" class="mb-6">
        <h4 class="text-sm font-medium text-gray-500 mb-2">Descripción</h4>
        <p class="text-gray-900 leading-relaxed">{{ tarjetaData()?.about_info?.description }}</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div *ngIf="tarjetaData()?.about_info?.skills && (tarjetaData()?.about_info?.skills?.length ?? 0) > 0">
          <h4 class="text-sm font-medium text-gray-500 mb-2">Habilidades</h4>
          <div class="flex flex-wrap gap-2">
            <span 
              *ngFor="let skill of tarjetaData()?.about_info?.skills"
              class="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full"
            >
              {{ skill }}
            </span>
          </div>
        </div>

        <div *ngIf="tarjetaData()?.about_info?.experience">
          <h4 class="text-sm font-medium text-gray-500 mb-2">Experiencia</h4>
          <p class="text-gray-900">
            {{ tarjetaData()?.about_info?.experience }} 
            {{ tarjetaData()?.about_info?.experience === 1 ? 'año' : 'años' }}
          </p>
        </div>
      </div>
    </div>

    <!-- Panel de acciones avanzadas -->
    <div class="bg-gray-50 rounded-lg p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Acciones</h3>
      
      <!-- Acciones principales -->
      <div class="flex flex-wrap gap-3 mb-6">
        <button
          (click)="editar()"
          class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center"
        >
          <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
          </svg>
          Editar Tarjeta
        </button>

        <button
          (click)="duplicar()"
          class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center"
        >
          <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path d="M7 9a2 2 0 012-2h6a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9z"></path>
            <path d="M5 3a2 2 0 00-2 2v6a2 2 0 002 2V5h8a2 2 0 00-2-2H5z"></path>
          </svg>
          Duplicar Tarjeta
        </button>
        
        <button
          (click)="abrirVistaPrevia()"
          class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center"
        >
          <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"></path>
            <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path>
          </svg>
          Vista Previa
        </button>

        <button
          (click)="eliminar()"
          class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center"
        >
          <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd"></path>
            <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"></path>
          </svg>
          Eliminar Tarjeta
        </button>
      </div>

      <!-- Acciones secundarias -->
      <div class="border-t border-gray-200 pt-4">
        <div class="flex flex-wrap gap-3">
          <button
            (click)="copiarUrlPublica()"
            class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors flex items-center text-sm"
          >
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path d="M8 2a1 1 0 000 2h2a1 1 0 100-2H8z"></path>
              <path d="M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11.586l-3-3a1 1 0 00-1.414 1.414L11.586 11H9a1 1 0 100 2h2.586l-1 1a1 1 0 101.414 1.414l3-3z"></path>
            </svg>
            Copiar URL Pública
          </button>

          <div class="text-xs text-gray-500 flex items-center">
            <span>URL: {{ obtenerUrlPublica() }}</span>
          </div>

          <button
            (click)="volver()"
            class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors flex items-center"
          >
            <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path>
            </svg>
            Volver a Lista
          </button>
        </div>
      </div>
    </div>

  </div>
</div>